{% extends "base.html" %}{% block content %}<h3 class="pl-4">Time series forecasting</h3><p class="pl-4">Dow Jones Industrial Average, S&P 500, and NASDAQ Composite</p><div id="time_series"></div><script src="https://d3js.org/d3.v5.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script><script>    // get json data  let dji = {{dji_json | safe}};  let sp500 = {{sp500_json | safe}};  let nasdaq = {{nasdaq_json | safe}};  let dji_predict = {{dji_predict_json | safe}};  let sp500_predict = {{sp500_predict_json | safe}};  let nasdaq_predict = {{nasdaq_predict_json | safe}};  dji_adj_price = [];  dji.forEach(function(entry){      dji_adj_price.push({"date": entry.date, "adj_price": entry.adj_close})  })  sp500_adj_price = [];  nasdaq_adj_price = [];  Date.prototype.addDays = function(days) {    const date = new Date(this.valueOf());    date.setDate(date.getDate() + days);    return date;  }  // create the days for the predicted value  let dji_final_day = dji[dji["length"]-1].date;  let last_day = (new Date(dji_final_day)).addDays(1)  let last_day_predict_utc = new Date(last_day.getUTCFullYear(), last_day.getUTCMonth(), last_day.getUTCDate())  last_day_predict_utc.setDate(last_day_predict_utc.getUTCDate() + Object.keys(dji_predict).length+1) // +1 because inclusive  function getDates(startDate, endDate){    const dateArray = [];    let currentDate = startDate;    while (currentDate <= endDate) {        dateArray.push(new Date (currentDate));        currentDate = currentDate.addDays(1);    }    return dateArray;  }  const getDatesArray = getDates(last_day, last_day_predict_utc)  // create json of dates and predict value  dji_predict_json = []  sp500_predict_json = []  nasdaq_predict_json = []  for (let i=0; i < getDatesArray.length; i++){      dji_predict_json.push({ "date": getDatesArray[i], "adj_close": dji_predict[i][0] })      sp500_predict_json.push({ "date": getDatesArray[i], "adj_close": sp500_predict[i][0] })      nasdaq_predict_json.push({ "date": getDatesArray[i], "adj_close": nasdaq_predict[i][0] })  }  dji_full = dji.push(dji_predict_json)</script>{% endblock %}